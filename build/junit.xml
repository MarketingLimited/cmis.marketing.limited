<?xml version="1.0" encoding="UTF-8"?>
<testsuites>
  <testsuite name="CLI Arguments" tests="19" assertions="6" errors="13" failures="1" skipped="0" time="18.215408">
    <testsuite name="Tests\Unit\Jobs\SendEmailCampaignJobTest" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" tests="5" assertions="5" errors="0" failures="1" skipped="0" time="15.514231">
      <testcase name="it_sends_email_to_recipients" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" line="29" class="Tests\Unit\Jobs\SendEmailCampaignJobTest" classname="Tests.Unit.Jobs.SendEmailCampaignJobTest" assertions="1" time="15.124249">
        <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\Jobs\SendEmailCampaignJobTest::it_sends_email_to_recipients
The expected [2] mailable was not sent.
Failed asserting that false is true.

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/MailFake.php:92
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php:363
/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php:63</failure>
        <system-out>Enabling RLS on cmis.orgs...
Enabling RLS on cmis.org_markets...
Enabling RLS on cmis.user_orgs...
Enabling RLS on cmis.campaigns...
Enabling RLS on cmis.content_plans...
Enabling RLS on cmis.content_items...
Enabling RLS on cmis.creative_assets...
Enabling RLS on cmis.ad_accounts...
Enabling RLS on cmis.ad_campaigns...
Enabling RLS on cmis.ad_sets...
Enabling RLS on cmis.ad_entities...
Enabling RLS on cmis.ad_metrics...
Creating RLS policy for cmis.orgs...
Creating RLS policy for cmis.org_markets...
Creating RLS policy for cmis.user_orgs...
Creating RLS policy for cmis.campaigns...
Creating RLS policy for cmis.content_plans...
Creating RLS policy for cmis.content_items...
Creating RLS policy for cmis.creative_assets...
Creating RLS policy for cmis.ad_accounts...
Creating RLS policy for cmis.ad_campaigns...
Creating RLS policy for cmis.ad_sets...
Creating RLS policy for cmis.ad_entities...
Creating RLS policy for cmis.ad_metrics...
Row-Level Security enabled successfully!

‚ö†Ô∏è  CRITICAL MIGRATION: Converting users.user_id from BIGINT to UUID
This will invalidate all existing user sessions and API tokens.
Press Ctrl+C within 10 seconds to abort...

Step 1/10: Checking current schema...
‚úì Users table already uses UUID. Skipping migration.

üìä Adding performance indexes...

Creating indexes for campaigns table...
‚úì Created index: idx_campaigns_org_status
‚úì Created index: idx_campaigns_dates
‚úì Created index: idx_campaigns_created
Creating indexes for content_plans table...
‚úì Created index: idx_content_plans_campaign
‚úì Created index: idx_content_plans_org_created
Creating indexes for content_items table...
‚úì Created index: idx_content_items_plan
‚úì Created index: idx_content_items_status
Creating indexes for ad_accounts table...
‚úì Created index: idx_ad_accounts_status
Creating indexes for ad_campaigns table...
‚ö† Warning: Could not create index idx_ad_campaigns_account: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "ad_account_id" does not exist (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_ad_campaigns_account
                    ON cmis.ad_campaigns (ad_account_id, status)
                )
‚ö† Warning: Could not create index idx_ad_campaigns_dates: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_ad_campaigns_dates
                    ON cmis.ad_campaigns (start_date, end_date)
                )
Creating indexes for ad_metrics table...
‚ö† Warning: Could not create index idx_ad_metrics_entity_date: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_ad_metrics_entity_date
                    ON cmis.ad_metrics (ad_entity_id, recorded_at DESC)
                )
‚ö† Warning: Could not create index idx_ad_metrics_date: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_ad_metrics_date
                    ON cmis.ad_metrics (recorded_at DESC)
                )
‚ö† Warning: Could not create index idx_ad_metrics_campaign: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_ad_metrics_campaign
                    ON cmis.ad_metrics (ad_campaign_id, recorded_at DESC)
                )
Creating indexes for user_orgs table...
‚ö† Warning: Could not create index idx_user_orgs_user: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_user_orgs_user
                    ON cmis.user_orgs (user_id, is_active)
                )
‚ö† Warning: Could not create index idx_user_orgs_org: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_user_orgs_org
                    ON cmis.user_orgs (org_id, is_active)
                )
Creating indexes for creative_assets table...
‚ö† Warning: Could not create index idx_creative_assets_org: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_creative_assets_org
                    ON cmis.creative_assets (org_id, asset_type)
                )
‚ö† Warning: Could not create index idx_creative_assets_created: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_creative_assets_created
                    ON cmis.creative_assets (created_at DESC)
                )
Creating indexes for compliance_audits table...
‚ö† Warning: Could not create index idx_compliance_audits_content: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_compliance_audits_content
                    ON cmis.compliance_audits (content_item_id)
                )
‚ö† Warning: Could not create index idx_compliance_audits_status: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_compliance_audits_status
                    ON cmis.compliance_audits (status, created_at DESC)
                )
Creating indexes for activity_logs table...
‚ö† Warning: Could not create index idx_audit_user_date: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_audit_user_date
                    ON cmis_audit.activity_logs (user_id, created_at DESC)
                )
‚ö† Warning: Could not create index idx_audit_action: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_audit_action
                    ON cmis_audit.activity_logs (action, created_at DESC)
                )
‚ö† Warning: Could not create index idx_audit_model: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_audit_model
                    ON cmis_audit.activity_logs (model_type, model_id)
                )
Creating indexes for personal_access_tokens table...
‚ö† Warning: Could not create index idx_tokens_tokenable: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_tokens_tokenable
                    ON personal_access_tokens (tokenable_type, tokenable_id)
                )
‚ö† Warning: Could not create index idx_tokens_created: SQLSTATE[25P02]: In failed sql transaction: 7 ERROR:  current transaction is aborted, commands ignored until end of transaction block (Connection: pgsql, SQL: 
                    CREATE INDEX IF NOT EXISTS idx_tokens_created
                    ON personal_access_tokens (created_at DESC)
                )

‚úì All performance indexes created successfully!
‚úì Query performance should be significantly improved


üìä Adding foreign key constraints for user reference columns...

‚ö†Ô∏è  Could not add FK fk_user_permissions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_user_activities_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_user_sessions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_sessions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_scheduled_social_posts_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_security_context_audit_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_audience_templates_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_campaign_context_links_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_campaigns_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_integrations_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_roles_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_campaign_context_links_updated_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_integrations_updated_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_team_invitations_invited_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...
‚ö†Ô∏è  Could not add FK fk_user_orgs_invited_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint matching given keys fo...

‚úÖ Foreign key migration complete!
   Added: 0
   Skipped: 15

‚úì Fixed performance_metrics constraints
‚úì Notifications table created with RLS policies

üìä Creating foreign keys directly...

‚ö†Ô∏è  Could not add FK fk_user_permissions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_user_activities_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_user_sessions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_sessions_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_scheduled_social_posts_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_security_context_audit_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_notifications_user: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_audience_templates_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_campaign_context_links_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_campaigns_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_integrations_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_roles_created_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_campaign_context_links_updated_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_integrations_updated_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_team_invitations_invited_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚ö†Ô∏è  Could not add FK fk_user_orgs_invited_by: SQLSTATE[42830]: Invalid foreign key: 7 ERROR:  there is no unique constraint ma...
‚úì Added FK: fk_notifications_org on cmis.notifications.org_id -&gt; cmis.orgs.org_id

‚úÖ Foreign key creation complete!
   Added: 1
   Skipped: 16

‚úì Added updated_at to cmis.orgs
‚úì Added created_at to cmis.user_orgs
‚úì Added updated_at to cmis.user_orgs
‚úì Added created_at to cmis.org_markets
‚úì Added updated_at to cmis.org_markets
‚úì Added updated_at to cmis.ad_campaigns
‚úì Added updated_at to cmis.ad_metrics
‚úì Added updated_at to cmis.ai_actions
‚úì Added updated_at to cmis.ai_generated_campaigns
‚úì Added updated_at to cmis.ai_models
‚úì Added updated_at to cmis.cognitive_tracker_template
‚úì Added updated_at to cmis.cognitive_trends
‚úì Added updated_at to cmis.compliance_audits
‚úì Added updated_at to cmis.content_plans
‚úì Added updated_at to cmis.contexts
‚úì Added updated_at to cmis.contexts_base
‚úì Added updated_at to cmis.copy_components
‚úì Added updated_at to cmis.creative_assets
‚úì Added updated_at to cmis.creative_briefs
‚úì Added updated_at to cmis.experiments
‚úì Added updated_at to cmis.export_bundles
‚úì Added updated_at to cmis.field_definitions
‚úì Added updated_at to cmis.field_values
‚úì Added updated_at to cmis.job_batches
‚úì Added updated_at to cmis.jobs
‚úì Added updated_at to cmis.meta_documentation
‚úì Added updated_at to cmis.meta_field_dictionary
‚úì Added updated_at to cmis.meta_function_descriptions
‚úì Added updated_at to cmis.offerings_full_details
‚úì Added updated_at to cmis.offerings_old
‚úì Added updated_at to cmis.password_reset_tokens
‚úì Added updated_at to cmis.predictive_visual_engine
‚úì Added updated_at to cmis.reference_entities
‚úì Added updated_at to cmis.roles
‚úì Added updated_at to cmis.security_context_audit
‚úì Added updated_at to cmis.social_post_metrics
‚úì Added updated_at to cmis.social_posts
‚úì Added updated_at to cmis.team_account_access
‚úì Added updated_at to cmis.user_activities
‚úì Added updated_at to cmis.user_sessions
‚úì Added updated_at to cmis.value_contexts
‚úì Added created_at to cmis.permissions
‚úì Added updated_at to cmis.permissions
‚úì Added created_at to cmis.role_permissions
‚úì Added updated_at to cmis.role_permissions
‚úì Added created_at to cmis.user_permissions
‚úì Added updated_at to cmis.user_permissions
‚úì Added created_at to cmis.social_accounts
‚úì Added created_at to cmis.team_invitations
‚úì Added updated_at to cmis.team_invitations
‚úì Added created_at to cmis.sessions
‚úì Added updated_at to cmis.sessions
‚úì Added current_org_id to cmis.users
‚úì Added status to cmis.users
‚úì Added id column to cmis.notifications
‚úì Created transaction context functions
‚úì Added notifiable_type and notifiable_id to cmis.notifications
‚úì Added post_id to cmis.scheduled_social_posts
‚úì Added metadata to cmis.users
‚úì Added primary key to cmis.users(user_id)
‚úì Added account_username to cmis.integrations
‚úì Added account_name to cmis.integrations
‚úì Added refresh_token to cmis.integrations
‚úì Added token_expires_at to cmis.integrations
‚úì Added expires_at to cmis.integrations
‚úì Added status to cmis.integrations
‚úì Added metadata to cmis.integrations
‚úì Added scopes to cmis.integrations
‚úì Added user_org_id to cmis.user_orgs
‚úì Added invited_at to cmis.user_orgs
‚úì Made campaign_external_id nullable in cmis.ad_campaigns
‚úì Created table: cmis.team_members
‚úì Created table: cmis.leads
‚úì Created table: cmis.webhooks
‚úì Created table: cmis.contacts
‚úì Created table: cmis.knowledge_index
‚úì Created table: cmis.subscriptions
‚úì Created table: cmis.api_logs
‚úì Created table: cmis.content_plan_items
‚úì Created table: cmis.offerings
‚úì Created table: cmis.content
‚úì Created table: cmis.platform_connections
‚úì Created table: cmis.assets
‚úì Created table: cmis.invoices
‚úì Created table: cmis.audiences
‚úì Created table: cmis.templates
‚úì Created table: cmis.posts
‚úì Created table: cmis.custom_fields
‚úì Created table: cmis.comments
‚úì Created table: cmis.budgets
‚úì Created table: cmis.audit_logs

‚úÖ Migration complete! Created 20 missing tables.
‚úì Added code column to public.markets
‚úì Updated cmis.markets view to include code column
‚úì Added name column to cmis.permissions

‚úÖ Added missing columns successfully!
‚úì Created table: cmis.audience_segments
‚úì Created table: cmis.analytics_snapshots
‚úì Created table: cmis.analytics_reports
‚úì Created table: cmis.activities
‚úì Created table: cmis.workflows
‚úì Created table: cmis.tags
‚úì Created table: cmis.notification_preferences
‚úì Created table: cmis.metrics
‚úì Created table: cmis.content_media
‚úì Created table: cmis.campaign_budgets

‚úÖ Migration complete! Created 10 additional tables.
‚úì Added team_member_id to team_members
‚úì Added updated_at to api_logs
‚úì Added name to markets
‚úì Added knowledge_id to knowledge_index
‚úì Added platform to posts
‚úì Added commentable_type to comments
‚úì Added commentable_id to comments
‚úì Added total_amount to budgets
‚úì Added title to knowledge_index
‚úì Added score to leads
‚úì Added log_id to audit_logs

‚úÖ All column fixes applied successfully!
‚úì Created table: cmis.activity_logs
‚úì Created table: cmis.settings
‚úì Created table: cmis.schedules
‚úì Created table: cmis.campaign_analytics
‚úì Created table: cmis.social_posts_v2
‚úì Created table: cmis.social_accounts_v2
‚úì Created table: cmis.content_plans_v2
‚úì Created table: cmis.scheduled_social_posts_v2
‚úì Created table: cmis.embeddings_cache
‚úì Created table: cmis.campaign_metrics

‚úÖ Migration complete! Created 10 additional tables.
‚úì Made event_type nullable in webhooks
‚úì Made plan_id nullable in content_plan_items
‚úì Made role_name nullable in roles
‚úì Made permission_code nullable in permissions
‚úì Made brief_data nullable in creative_briefs

‚úÖ All NULL constraint fixes applied!
‚úì Added usage_count to assets
‚úì Added report_name to analytics_reports
‚úì Added activity_id to activity_logs
‚úì Added status column to cmis.user_orgs
‚úì Added ad_account_id to cmis.ad_campaigns
‚úì Added updated_at to public.markets
‚úì Created personal_access_tokens table
‚úì Made role_code nullable in cmis.roles
‚úì Made audience_id nullable in cmis.audience_segments
‚úì Updated cmis.markets view with correct columns

‚úÖ All critical schema fixes applied successfully!
‚úì Made user_id nullable in cmis.team_members
‚úì Made permission_name nullable in cmis.permissions
‚úì Made content_id nullable in cmis.content_media
‚úì Verified plan_id is nullable in cmis.content_items
‚úì Updated cmis.markets view to include both market_name and name

‚úÖ All NOT NULL constraint fixes applied successfully!
Fixing pgvector dimension mismatch (1536 ‚Üí 768)...
‚úì cmis.knowledge_index.embedding already correct or doesn't exist

‚úÖ All pgvector dimension fixes applied successfully!
Note: Gemini text-embedding-004 produces 768-dimensional vectors.
</system-out>
      </testcase>
      <testcase name="it_can_be_dispatched" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" line="72" class="Tests\Unit\Jobs\SendEmailCampaignJobTest" classname="Tests.Unit.Jobs.SendEmailCampaignJobTest" assertions="1" time="0.088750"/>
      <testcase name="it_handles_errors_gracefully" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" line="165" class="Tests\Unit\Jobs\SendEmailCampaignJobTest" classname="Tests.Unit.Jobs.SendEmailCampaignJobTest" assertions="1" time="0.130187"/>
      <testcase name="it_tracks_sent_emails" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" line="130" class="Tests\Unit\Jobs\SendEmailCampaignJobTest" classname="Tests.Unit.Jobs.SendEmailCampaignJobTest" assertions="1" time="0.078829"/>
      <testcase name="it_personalizes_content" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendEmailCampaignJobTest.php" line="95" class="Tests\Unit\Jobs\SendEmailCampaignJobTest" classname="Tests.Unit.Jobs.SendEmailCampaignJobTest" assertions="1" time="0.092217"/>
    </testsuite>
    <testsuite name="Tests\Unit\Jobs\PublishToFacebookJobTest" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" tests="6" assertions="0" errors="6" failures="0" skipped="0" time="2.080158">
      <testcase name="it_handles_publishing_errors" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="89" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.377849">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_handles_publishing_errors
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (7e3b513b-6b26-4df6-bcf6-c7b9d8c7fe33, null, edd26463-8b2a-4b1f-a5eb-87457acea6be, 2025-11-20 17:13:19+01, pending, null, 2025-11-20 17:13:19+01, 2025-11-20 17:13:19+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (edd26463-8b2a-4b1f-a5eb-87457acea6be, 2025-11-20 17:13:19, pending, 7e3b513b-6b26-4df6-bcf6-c7b9d8c7fe33, 2025-11-20 17:13:19, 2025-11-20 17:13:19))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:96</error>
      </testcase>
      <testcase name="it_updates_post_metadata_on_success" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="153" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.354357">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_updates_post_metadata_on_success
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (9b6ac957-d363-49e4-b637-953bf3d7bbaf, null, a79b45e7-f281-4a51-9328-a8cce823c19b, 2025-11-20 17:13:19+01, pending, null, 2025-11-20 17:13:19+01, 2025-11-20 17:13:19+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (a79b45e7-f281-4a51-9328-a8cce823c19b, 2025-11-20 17:13:19, pending, 9b6ac957-d363-49e4-b637-953bf3d7bbaf, 2025-11-20 17:13:19, 2025-11-20 17:13:19))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:160</error>
      </testcase>
      <testcase name="it_retries_on_failure" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="126" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.332730">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_retries_on_failure
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (20da85db-92dc-408c-b7e9-163254e6e77b, null, 68614894-9267-4b56-a4ae-b8e564c53fc4, 2025-11-20 17:13:20+01, pending, null, 2025-11-20 17:13:20+01, 2025-11-20 17:13:20+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (68614894-9267-4b56-a4ae-b8e564c53fc4, 2025-11-20 17:13:20, pending, 20da85db-92dc-408c-b7e9-163254e6e77b, 2025-11-20 17:13:20, 2025-11-20 17:13:20))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:133</error>
      </testcase>
      <testcase name="it_validates_post_content_before_publishing" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="188" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.323216">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_validates_post_content_before_publishing
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (adb01157-8b6e-449f-8d5f-8b1283f8b1fa, null, 24a63f6d-33b0-48bb-9fe5-b936a1bcd5db, 2025-11-20 17:13:20+01, pending, null, 2025-11-20 17:13:20+01, 2025-11-20 17:13:20+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (24a63f6d-33b0-48bb-9fe5-b936a1bcd5db, 2025-11-20 17:13:20, pending, adb01157-8b6e-449f-8d5f-8b1283f8b1fa, 2025-11-20 17:13:20, 2025-11-20 17:13:20))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:193</error>
      </testcase>
      <testcase name="it_can_be_dispatched" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="28" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.328902">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_can_be_dispatched
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (b8ade3ca-2991-484e-989d-07104b81c4c3, null, 12a9fb64-954c-486b-8500-e36470c23863, 2025-11-20 18:13:20+01, pending, null, 2025-11-20 17:13:20+01, 2025-11-20 17:13:20+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (12a9fb64-954c-486b-8500-e36470c23863, 2025-11-20 18:13:20, pending, b8ade3ca-2991-484e-989d-07104b81c4c3, 2025-11-20 17:13:20, 2025-11-20 17:13:20))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:35</error>
      </testcase>
      <testcase name="it_publishes_post_to_facebook" file="/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php" line="55" class="Tests\Unit\Jobs\PublishToFacebookJobTest" classname="Tests.Unit.Jobs.PublishToFacebookJobTest" assertions="0" time="0.363103">
        <error type="Illuminate\Database\QueryException">Tests\Unit\Jobs\PublishToFacebookJobTest::it_publishes_post_to_facebook
Illuminate\Database\QueryException: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "social_post_id" of relation "scheduled_social_posts_v2" violates not-null constraint
DETAIL:  Failing row contains (46c7407b-a273-4f85-ae0b-4f4c64165f00, null, 70d34354-a60b-4045-ac28-4b61ea7f302d, 2025-11-20 17:13:21+01, pending, null, 2025-11-20 17:13:21+01, 2025-11-20 17:13:21+01). (Connection: pgsql, SQL: insert into "cmis"."scheduled_social_posts_v2" ("org_id", "scheduled_at", "status", "scheduled_post_id", "updated_at", "created_at") values (70d34354-a60b-4045-ac28-4b61ea7f302d, 2025-11-20 17:13:21, pending, 46c7407b-a273-4f85-ae0b-4f4c64165f00, 2025-11-20 17:13:21, 2025-11-20 17:13:21))

/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:778
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:559
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Connection.php:523
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php:3804
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:2235
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1412
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:1240
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1219
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:390
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php:1218
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Support/Traits/ForwardsCalls.php:23
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2540
/home/cmis-test/public_html/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:2556
/home/cmis-test/public_html/tests/Unit/Jobs/PublishToFacebookJobTest.php:62</error>
      </testcase>
    </testsuite>
    <testsuite name="Tests\Unit\Jobs\SendSMSJobTest" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" tests="8" assertions="1" errors="7" failures="0" skipped="0" time="0.621019">
      <testcase name="it_supports_message_personalization" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="150" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.070885">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_supports_message_personalization
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:165</error>
      </testcase>
      <testcase name="it_can_be_dispatched" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="89" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="1" time="0.076264"/>
      <testcase name="it_splits_long_messages" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="248" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.078015">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_splits_long_messages
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:263</error>
      </testcase>
      <testcase name="it_handles_rate_limiting" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="214" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.083494">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_handles_rate_limiting
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:229</error>
      </testcase>
      <testcase name="it_sends_arabic_message" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="58" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.089539">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_sends_arabic_message
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:73</error>
      </testcase>
      <testcase name="it_handles_invalid_phone_number" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="117" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.074121">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_handles_invalid_phone_number
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:132</error>
      </testcase>
      <testcase name="it_sends_sms_to_contact" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="29" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.067773">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_sends_sms_to_contact
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:44</error>
      </testcase>
      <testcase name="it_tracks_sms_delivery_status" file="/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php" line="181" class="Tests\Unit\Jobs\SendSMSJobTest" classname="Tests.Unit.Jobs.SendSMSJobTest" assertions="0" time="0.080928">
        <error type="Error">Tests\Unit\Jobs\SendSMSJobTest::it_tracks_sms_delivery_status
Error: Call to undefined method Tests\Unit\Jobs\SendSMSJobTest::mockSMSProvider()

/home/cmis-test/public_html/tests/Unit/Jobs/SendSMSJobTest.php:196</error>
      </testcase>
    </testsuite>
  </testsuite>
</testsuites>
